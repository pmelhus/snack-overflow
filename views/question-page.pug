extends layout.pug

include utils.pug

block styles
    script(src="/javascripts/questions.js" type="module" defer)
    script(src="/javascripts/answers.js" type="module" defer)
    link(rel="stylesheet" href="/stylesheets/question-page.css")
    link(rel='stylesheet' href='/stylesheets/index.css')


block content
    div(id='q-head')
        h2 #{question.title}
        p asked at #{question.createdAt}
        a(id='ask-q' href='./new') New Question
    div
        p #{question.body}
        if user && (user.id === question.userId)
            div
                 button: a(href=`./${question.id}/edit`) Edit
                 a(href=`/questions/${id}/delete`) Delete

    div(id="answerId")
        p(value="0") #{answers.length} answer
        //- add the correct starting count for each question!!



    div(id="answer")
        each answer in answers


            div(class='a-card')

                //- button: a(//- VOTE ROUTING -//) Upvote Answer
                //- p: #{answer.answerScore}
                //- button: a(//- VOTE ROUTING -//) Downvote Answer

                p(id='answerDate') answered at #{answer.createdAt.toLocaleTimeString()} ||
                p(id=`answerBody-${answer.id}`) #{answer.body}
                if user && (user.id === answer.userId)
                    button(class='editButton' id=`edit-button-${answer.id}`) Edit
                    form(class='hidden' id=`edit-form-${answer.id}`)
                        textarea(name="content" id=`${answer.id}-edit-content`) #{answer.body}
                        button(class="edit-submit" id=`edit-submit-${answer.id}`) Submit Edit
                //- if answer.user_id == //-TODO: CURRENT USER FROM SESSION
                    button: a(href='questions/#{question.id}/answers/#{answer.id}/edit') Edit Answer
                    button: a(href='questions/#{question.id}/answers/#{answer.id}/delete') Delete Answer
    div(id='a-form')
        p Your Answer
        form(action='')
            +textarea('Body', 'body', body)
            button(id='submit-a') New Answer
